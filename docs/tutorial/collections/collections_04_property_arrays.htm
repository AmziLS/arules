<html><!-- #BeginTemplate "/Templates/tutorial_collections.dwt" --><!-- DW6 -->
<!-- saved from url=about:internet -->
<head>
<link rel="stylesheet" type="text/css"
href="../../arulesxl.css" />
<!-- #BeginEditable "doctitle" -->
<title>ARulesXL</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>
<body bgcolor="#FFFFFF" text="#000033" link="#990066" vlink="#990099" alink="#9900FF">
<table width=100%>
<tr>
<td><h1><!-- #BeginEditable "head" -->Multiple Investors, Fact Arrays<!-- #EndEditable --></h1></td>
    <td><a href="http://www.arulesxl.com" target="_top"><img src="../../images/logo.gif" width="150" height="115" border="0" align="right"></a></td>
</tr>
</table>
<hr>
<p><font size="-1"><b><a href="../../tutorial.htm" target=_top>Tutorial Index</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="collections_01-02_rules_decision_tables.htm" target=_top>Rules &amp; Decision Tables</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="collections_03_column_queries.htm" target=_top>Column Queries</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="collections_04_property_arrays.htm" target=_top>Arrays</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="collections_05_data_tables.htm">Tables &amp; Pattern Matching</a>&nbsp;&nbsp;&nbsp;&nbsp; <a href="collections_06_lists.htm" target=_top>Lists</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="collections_07_vba.htm" target=_top>VBA</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="collections_08_modules.htm" target=_top>Multiple Rule Sets</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="collections_09_array_queries.htm" target=_top>Array Queries</a></b></font></p>
<hr>
<!-- #BeginEditable "body" --> 
<h3><i><a name="loans_04_property_arrays"></a>loans_04_property_arrays.xls</i></h3>
<p>In this example there are two investors to consider, each with different criteria 
  for the loans they will accept. They are Ace and Acme.</p>
<p>There are different ways to write the rules for the different investors. One 
  way is to simply add a criteria to each rule:</p>
<pre>Resell = &quot;yes&quot; WHEN investor = &quot;Ace&quot; AND ...</pre>
<p>A more flexible way, that better separates the rules for different investors, 
  is to use fact arrays.</p>
<p>A fact can have array indices associated with it in square brackets. For this 
  example <var>Resell</var> is a fact array with decision tables for both <var>Resell[Ace]</var> 
  and <var>Resell[Acme]</var>. Using these tables, the <code>RQuery()</code> now 
  asks for either Resell['Acme'] or Resell['Ace'] as shown in the screen shot 
  below. The single quotes are used instead of double quotes to make it easier 
  to create and read the query.</p>
<p><img src="images/collections_04_property_arrays.gif" width="804" height="666"><br>
  <font size="-1"><b>loans_04_property_arrays.xls</b></font></p>
<p>Fact arrays can be used just as easily with rules instead of decision tables. 
  Two such rules for this example would be:</p>
<pre>Resell[Ace] = &quot;yes&quot; WHEN FICO &gt;= 720 AND LTV &gt;= 90
Resell[Acme] = &quot;yes&quot; WHEN FICO &gt;= 680 AND Rate &gt; 6.2 and Occupancy  = &quot;Owner&quot; </pre>
<p>Also, rather than hard coding the investor name in the query, it could be taken 
  from that name at the top of the column. In that case the RQuery() in cell J6 
  would read as follows, picking up the investor name from cell J4:</p>
<pre>=RQuery(ResaleRules, &quot;FIND Resell[_1] WHEN FICO = _2 AND...      &quot;, J4, D6, ... ) </pre>
<!-- #EndEditable --> 
<hr>
<table width=100%>
<tr>
<td>
<img src="../../images/logo_very_small.gif">
</td>
<td>
<h2 align="right">
<font size="2"><i>Copyright &copy;2005-7 <a href="http://www.amzi.com/">Amzi! inc.</a> All Rights Reserved.</i></font><br>
<font size="1"><i>ARulesXL and Amzi! are trademarks or registered trademarks of Amzi! <br>
Microsoft and Excel  are trademarks or registered trademarks of   Microsoft Corporation.</i></font></h2>
</td>
</tr>
</table>
</body>
<!-- #EndTemplate --></html>
