<html><!-- #BeginTemplate "/Templates/tutorial.dwt" --><!-- DW6 -->
<!-- saved from url=about:internet -->
<head>
<link rel="stylesheet" type="text/css"
href="../arulesxl.css" />
<!-- #BeginEditable "doctitle" -->
<title>Tutorial - Debugging Queries</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>
<body bgcolor="#FFFFFF" text="#000033" link="#990066" vlink="#990099" alink="#9900FF">
<table width=100%>
<tr>
<td><h1><!-- #BeginEditable "head" -->Tutorial<br>
<font size=4>Debugging Queries </font><!-- #EndEditable --></h1></td>
    <td><a href="http://www.arulesxl.com" target="_top"><img src="../images/logo.gif" width="150" height="115" border="0" align="right"></a></td>
</tr>
</table>
<hr>
<p><font size="-1"><b><a href="../index.htm" target=_top>Top</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../index_install.htm" target=_top>Installation</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../index_intro.htm" target=_top>Introduction</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../samples.htm">Samples</a>&nbsp;&nbsp;&nbsp;&nbsp; <a href="../index_tutor.htm" target=_top>Tutorial</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../index_ref.htm" target=_top>Reference</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../release_notes.htm" target=_top>Release Notes</a></b></font></p>
<hr>
<!-- #BeginEditable "body" --> 
<p> 
  <!amzi_index=Debugging; Explanations; Trace; Step>
  Because the rules are applied dynamically, it is sometimes difficult to understand 
  the reason why a complex rule set is not behaving correctly. The <b>ARulesXL 
  | Trace Query</b> command traces the behavior of the reasoning engine as it 
  applies the rules based on a query.</p>
<p>To start the trace, first select a cell with a query in it, such as A6 in the 
  sample. Then select <b>ARulesXL | Trace</b>.</p>
<p>The trace pops up a separate workbook and menu, which you can reposition for 
  easy viewing. You can dock the menu and it will appear in the docked position 
  next time you run trace.</p>
<p align="center"><img src="../images/Trace%2001.gif" width="435" height="146"></p>
<p>The buttons on the Trace menu are:</p>
<ul>
  <li>Step - Steps through the reasoning process.</li>
  <li>Skip - Skips the next part of the reasoning process.</li>
  <li>Run - Runs to the end of the reasoning process.</li>
  <li>End - Ends the reasoning process.</li>
  <li>Help - Displays the <a href="../reference/ref_debug.htm">Trace Reference</a> 
    documentation. </li>
</ul>
<p>The cell below the title has information and instructions for using the trace.</p>
<p>After two steps, the trace worksheet looks like this (note the Trace Menu is 
  docked above now):</p>
<p align=center><img src="../images/Trace%2002.gif" width="874" height="228"></p>
<p>The query being traced is echoed in the top section.</p>
<p>The <em>Action</em> section shows the current steps in the reasoning process. 
  In this case the trace indicates:</p>
<ul>
  <li>Find - the goal is to find the value of <var>UnitPrice</var></li>
  <li>Try - the first rule to try is the one in cell A2 (the rule is echoed to 
    the right)</li>
</ul>
<p>The <em>Known</em> section shows the values of properties that have already 
  been determine, and the source of that value. In this case there is just one: 
  The value of <var>Quantity</var> is known to be 25 based on input.</p>
<p>Continuing to select the step button shows the steps of evaluating rule A2:</p>
<p align=center><img src="../images/Trace%2003.gif" width="874" height="255"></p>
<p>In this case evaluating rule A2 requires:</p>
<ul>
  <li>The value of <var>Quantity</var>, which is known to be 25, and</li>
  <li>The result of testing <var>Quantity</var> &lt; 20</li>
</ul>
<p>If <em>skip</em> had been choosen instead of <em>step</em>, these details would 
  have been skipped, and the next step, indicating failure of rule A2 would have 
  been shown immediately.</p>
<p>Continuing, the trace works through the rule at A3 and finds the value of <var>UnitPrice</var>. 
  At this point the trace is done and you can close the trace worksheet.</p>
<p align=center><img src="../images/Trace%2004.gif" width="875" height="221"></p>
<p>The trace indicates it found the value of 8 using the rule at A3. Also note 
  that the list of known properties now includes <var>UnitPrice</var> and the 
  source of it's value.</p>
<p>The trace worksheet expands and collapses the trace as various rules are tried 
  and failed. The full history of the reasoning is also recorded in a text file 
  called 'arulesxl trace.txt'. It is in the directory with the workbook being 
  traced. It is in a semi-colon delimited format that corresponds to the columns 
  in the trace worksheet. You can display this file with the <b>ARulesXL | Open 
  Trace Log File</b> command. </p>
<p align=center><img src="../images/Trace%2005.gif" width="667" height="329"></p>
<p>Here we can see the history as first rule A2 is tried, and then rule A3.</p>
<p>Tracing is a valuable tool for both debugging and learning exactly how the 
  ARulesXL rule engine works.</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr> 
    <th width="50%" scope="col"> 
      <div align="left"> 
        <h3><a href="tutor_ruleset_query.htm">Previous</a></h3>
      </div>
    </th>
    <th width="50%" scope="col"> 
      <div align="right"> 
        <h3><a href="tutor_using_cell_values.htm">Next</a></h3>
      </div>
    </th>
  </tr>
  <tr> 
    <th colspan="2" scope="col"> 
      <h4><a href="tutor_debug.htm" target="_blank">Open in New Window to Print</a></h4>
    </th>
  </tr>
</table>
<!-- #EndEditable --> 
<hr>
<table width=100%>
<tr>
<td>
<img src="../images/logo_very_small.gif">
</td>
<td>
<h2 align="right">
<font size="2"><i>Copyright &copy;2005-7 <a href="http://www.amzi.com/">Amzi! inc.</a> All Rights Reserved.</i></font><br>
<font size="1"><i>ARulesXL and Amzi! are trademarks or registered trademarks of Amzi! <br>
Microsoft and Excel  are trademarks or registered trademarks of   Microsoft Corporation.</i></font></h2>
</td>
</tr>
</table>
</body>
<!-- #EndTemplate --></html>
