<html><!-- #BeginTemplate "/Templates/arulesxl.dwt" --><!-- DW6 -->
<!-- saved from url=about:internet -->
<head>
<link rel="stylesheet" type="text/css"
href="../arulesxl.css" />
<!-- #BeginEditable "doctitle" -->
<title>Reference - Optimizing Query Performance</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>
<body bgcolor="#FFFFFF" text="#000033" link="#990066" vlink="#990099" alink="#9900FF">
<table width=100%>
<tr>
<td><h1><!-- #BeginEditable "head" -->Reference<!-- #EndEditable --></h1></td>
    <td><a href="http://www.arulesxl.com" target="_top"><img src="../images/logo.gif" width="150" height="115" border="0" align="right"></a></td>
</tr>
</table>
<hr>
<p><font size="-1"><b><a href="../index.htm" target=_top>Top</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../install.htm">Installation</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../introduction.htm">Introduction</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../samples.htm">Samples</a>&nbsp;&nbsp;&nbsp;&nbsp; <a href="../tutorial.htm">Tutorial</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../reference.htm">Reference</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../release_notes.htm">Release Notes</a></b></font></p>
<hr>
<!-- #BeginEditable "body" --> 
<h2><a name="performance"></a>Optimizing Query
Performance</h2>
<!amzi_index=Performance>

<h3><a name="reexecuting_queries"></a>Re-Executing Queries</h3>
<p>
  <!amzi_index=RQuery()>
  Some applications have multiple <code>RQuery()</code> statements that all depend on 
  the same inputs. This could be the case in an application where the input 
  data is fed to the rules via <code>RArray()</code> and/or <code>RCell()</code>. Or maybe all the <code>RQuery()</code>  calls provide the same input data in the <code>WHEN</code> clause of the query.</p>
<p>In these cases, the derived facts from the first such query do not need 
  to be recalculated for the other queries. You can control this behavior 
  by having the first argument of <code>RQuery()</code> refer to a previous query, rather 
  than a rule set directly. Then that secondary query is only re-executed 
  when the first query is executed and the derived facts from the previous 
  query are saved, so they do not need to be recalculated.</p>
<p>For example:</p>
<pre>A3:  =RQuery(MainRules, "FIND ...
A4:  =RQuery(A3, "FIND ...
A5:  =RQuery(A3, "FIND ...</pre>
<p>The second and third queries above will not recalculate already derived 
  facts, and will only calculate those additional facts needed to satisfy 
  the query.</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <th width="100%" scope="col"><h4><a href="ref_performance.htm" target="_blank">Open in New Window to Print</a></h4></th>
  </tr>
</table>
<!-- #EndEditable --> 
<hr>
<table width=100%>
<tr>
<td>
<img src="../images/logo_very_small.gif">
</td>
<td>
<h2 align="right">
<font size="2"><i>Copyright &copy;2005-7 <a href="http://www.amzi.com/">Amzi! inc.</a> All Rights Reserved.</i></font><br>
<font size="1"><i>ARulesXL and Amzi! are trademarks or registered trademarks of Amzi! <br>
Microsoft and Excel  are trademarks or registered trademarks of   Microsoft Corporation.</i></font></h2>
</td>
</tr>
</table>
</body>
<!-- #EndTemplate --></html>
