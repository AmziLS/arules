<html><!-- #BeginTemplate "/Templates/arulesxl.dwt" --><!-- DW6 -->
<!-- saved from url=about:internet -->
<head>
<link rel="stylesheet" type="text/css"
href="../arulesxl.css" />
<!-- #BeginEditable "doctitle" -->
<title>Reference - The ARulesXL Reasoning Engine and Excel Calculation</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>
<body bgcolor="#FFFFFF" text="#000033" link="#990066" vlink="#990099" alink="#9900FF">
<table width=100%>
<tr>
<td><h1><!-- #BeginEditable "head" -->Reference<!-- #EndEditable --></h1></td>
    <td><a href="http://www.arulesxl.com" target="_top"><img src="../images/logo.gif" width="150" height="115" border="0" align="right"></a></td>
</tr>
</table>
<hr>
<p><font size="-1"><b><a href="../index.htm" target=_top>Top</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../install.htm">Installation</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../introduction.htm">Introduction</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../samples.htm">Samples</a>&nbsp;&nbsp;&nbsp;&nbsp; <a href="../tutorial.htm">Tutorial</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../reference.htm">Reference</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="../release_notes.htm">Release Notes</a></b></font></p>
<hr>
<!-- #BeginEditable "body" --> 
<h2><a name="reasoning_calculation"></a>The ARulesXL Reasoning Engine and Excel Calculation</h2>

<p>
  <!amzi_index=Reasoning; Calculation>
  A spreadsheet engine and a rule engine both resolve interconnected facts, rules 
  and formulas, but each in its own way, and each with its own advantages and 
  disadvantages.</p>
<h3><a name="spreadsheet_calculation"></a>Spreadsheet Calculation</h3>
<p>Each cell in a spreadsheet can be directly linked to other cells via formula. 
  These direct links are used by the spreadsheet to dynamically change the results 
  of formulas as the values in linked cells change.</p>
<p>The developer is responsible for coding the links between the cells.</p>
<p>The spreadsheet is a powerful tool for implementing numerical modeling applications.</p>
<h3><a name="rule_base_reasoning"></a>Rule Base Reasoning</h3>
<p>A rule base is a collection of rules stating relationships between facts, 
  values and the conditions. Unlike with spreadsheet formulas, the developer does 
  not specify direct links between related rules.</p>
<p>Instead, a rule engine dynamically chooses which rules to use based on the 
  values of input facts and fact values that are derived from the rules. 
  This allows the developer to concentrate on the relationships in the rules without 
  having to worry about a complex web of interconnected dependencies.</p>
<p>The rule engine works by choosing rules based on goals presented in queries 
  to the rules. A query asks for the value of a particular fact. First, the rule engine looks for a table that specifies the value for that fact. If none is found, then the rule 
  engine looks for rules that can be used to set a value for that fact. Those 
  rules might refer to other fact values, so the rule engine then sets sub goals 
  of looking for those values. In this manner, the rules applicable for a given 
  set of input data are dynamically applied to answer a query for a fact value.</p>
<p>The rule base is a powerful tool for implementing business rule applications.</p>
<h3><a name="calculation_reasoning_example"></a>Example</h3>
<p>Consider a loan application:</p>
<ul>
  <li>A spreadsheet is excellent for implementing the various formulas for mortgage 
    payments etc.</li>
  <li>A rule base is excellent for the specifications of the conditions when a 
    loan might be approved or not.</li>
</ul>
<h3><a name="integration"></a>Integration</h3>
<p>ARulesXL integrates the two on the spreadsheet, allowing rules to reference 
  spreadsheet calculations, and spreadsheet cells to query rule sets defined on 
  the spreadsheet. </p>
<h2><a name="reasoning_algorithm"></a>Reasoning Algorithm Step-by-Step </h2>
<p>
  <!amzi_index=Reasoning>
  ARulesXL uses a goal-driven reasoning algorithm. This means it starts with 
  the goal of finding a value for some fact. In the course of finding 
  that value, it might determine that it needs to find the values of other facts 
  as well.</p>
<p>The initial goal fact is the one provided in a query.</p>
<ol>
  <li>The reasoning algorithm looks for the first rule that sets the goal fact. 
    If it simply sets the value, then its done. If the rule has a WHEN clause, then 
    the conditions in the WHEN are tested, and if they evaluate to true, then the 
    value is set.</li>
  <li>If the WHEN clause evaluates to false, then the reasoning algorithm looks for 
    the next rule that sets a value for the goal fact until a value is 
    found.</li>
  <li>If no value is found in the current rule set, then, if there are super sets 
    of that rule set, the same goal is presented to each of the super set rule sets. 
    They might, in turn, call their super sets, and so on.</li>
  <li>In testing the conditions of the WHEN clause, it might be necessary to find 
    the values of other facts. These become sub goals, which are pursued 
    as necessary. The sub goals in a WHEN clause are only pursued as long as it 
    is possible that the conditions in that clause might be true.</li>
  <li>The pursuit of the sub goals might lead to further sub goals. The nesting of 
    goals can be arbitrarily deep.</li>
  <li>If the rule's conditions are true, and that rule sets it's property 
    value using a formula, then sub goals are pursued for each of the facts 
    used in that formula.</li>
</ol>
<p>Use the Trace facility to see this steps in action for any given ARulesXL RQuery().</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <th width="100%" scope="col"><h4><a href="ref_reasoning.htm" target="_blank">Open in New Window to Print</a></h4></th>
  </tr>
</table>
<!-- #EndEditable --> 
<hr>
<table width=100%>
<tr>
<td>
<img src="../images/logo_very_small.gif">
</td>
<td>
<h2 align="right">
<font size="2"><i>Copyright &copy;2005-7 <a href="http://www.amzi.com/">Amzi! inc.</a> All Rights Reserved.</i></font><br>
<font size="1"><i>ARulesXL and Amzi! are trademarks or registered trademarks of Amzi! <br>
Microsoft and Excel  are trademarks or registered trademarks of   Microsoft Corporation.</i></font></h2>
</td>
</tr>
</table>
</body>
<!-- #EndTemplate --></html>
